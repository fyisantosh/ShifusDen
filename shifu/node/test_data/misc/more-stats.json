{
    "opco": "marsh",
    "folks": 40,
    "stats": {
        "p": 10,
        "c": 15,
        "a": 5
    }
}

db.training.aggregate([
    {
        $unwind: "$trainees"
    },
    {
        $lookup: {
            from: "trainee",
            localField: "trainees.psno",
            foreignField: "_id",
            as: "trainee_detail"
        }
    },
    {
        $unwind: "$trainee_detail"
    },
    {
        $match: {
            "trainee_detail.opco": "Marsh"
        }
    },
    {
        $group: {
            "_id": {"opco":"$trainee_detail.opco", "status":"$trainees.status"},
            "crowd": {
                "$sum": 1
            }
        }
    },
    {
        "$group": {
            "_id": "$_id.opco",
            "stats": {
                "$push": {
                    "status": "$_id.status",
                    "count": "$crowd"
                }
            }
        }
    }
]).pretty()